import{w as c}from"./index.DBUyG4bT.js";const g=()=>{const{subscribe:a,set:n}=c({isLoggedIn:!1,user:null});if(typeof window<"u"){const o=localStorage.getItem("bisaBugar_auth");if(o)try{const e=JSON.parse(o);n(e)}catch(e){console.error("Failed to parse auth state:",e)}}return{subscribe:a,login:(o,e)=>{const t=l().find(i=>i.email===o);if(!t)return{success:!1,message:"Email tidak terdaftar"};if(t.password!==e)return{success:!1,message:"Password salah"};const r={isLoggedIn:!0,user:{id:t.id,name:t.name,email:t.email}};return n(r),localStorage.setItem("bisaBugar_auth",JSON.stringify(r)),{success:!0,message:"Login berhasil!"}},register:(o,e,s)=>{const t=l();if(t.some(u=>u.email===e))return{success:!1,message:"Email sudah terdaftar"};const r={id:crypto.randomUUID(),name:o,email:e,password:s};t.push(r),localStorage.setItem("bisaBugar_users",JSON.stringify(t));const i={isLoggedIn:!0,user:{id:r.id,name:r.name,email:r.email}};return n(i),localStorage.setItem("bisaBugar_auth",JSON.stringify(i)),{success:!0,message:"Pendaftaran berhasil!"}},logout:()=>{n({isLoggedIn:!1,user:null}),localStorage.removeItem("bisaBugar_auth")}}};function l(){if(typeof window>"u")return[];const a=localStorage.getItem("bisaBugar_users");if(!a)return[];try{return JSON.parse(a)}catch{return[]}}const b=g(),m=()=>{const{subscribe:a,set:n,update:o}=c([]);if(typeof window<"u"){const e=localStorage.getItem("bisaBugar_bookings");if(e)try{n(JSON.parse(e))}catch(s){console.error("Failed to parse bookings:",s)}}return{subscribe:a,add:e=>{const s={...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return o(t=>{const r=[...t,s];return localStorage.setItem("bisaBugar_bookings",JSON.stringify(r)),r}),s}}};m();const f=()=>{const{subscribe:a,set:n,update:o}=c([]);if(typeof window<"u"){const e=localStorage.getItem("bisaBugar_classes");if(e)try{n(JSON.parse(e))}catch(s){console.error("Failed to parse classes:",s)}}return{subscribe:a,register:e=>{const s={...e,id:crypto.randomUUID(),registeredAt:new Date().toISOString()};return o(t=>{const r=[...t,s];return localStorage.setItem("bisaBugar_classes",JSON.stringify(r)),r}),s},isRegistered:(e,s,t)=>{let r=!1;return a(u=>{r=u.some(d=>d.userId===e&&d.className===s&&d.day===t)})(),r}}};f();const S=()=>{const{subscribe:a,set:n,update:o}=c([]);if(typeof window<"u"){const e=localStorage.getItem("bisaBugar_promos");if(e)try{n(JSON.parse(e))}catch(s){console.error("Failed to parse promos:",s)}}return{subscribe:a,claim:(e,s)=>{const t={id:crypto.randomUUID(),userId:e,promoName:s,claimedAt:new Date().toISOString()};return o(r=>{const i=[...r,t];return localStorage.setItem("bisaBugar_promos",JSON.stringify(i)),i}),t},hasClaimed:(e,s)=>{let t=!1;return a(i=>{t=i.some(u=>u.userId===e&&u.promoName===s)})(),t}}};S();export{b as a};
